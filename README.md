# Timetracker CLI

A minimal CLI tool for time tracking using a REST API backend.

## Installation

```bash
cargo build --release
```

The binary will be available at `target/release/timetracker`.

## Configuration

The tool uses environment variables for API configuration. Create a `.env` file in the project root or set these environment variables:

```bash
API_DOMAIN=https://kv.srv.signalwerk.ch
API_PROJECT=timetracker
API_USERNAME=your_username
API_PASSWORD=your_password
TOKEN_CACHE_FILE=.token_cache.json  # Optional, defaults to .token_cache.json
```

## Logging

All actions are logged for debugging purposes:

- **Development mode**: `timetracker.log` in the current directory
- **Production mode**: `~/.timetracker.log` in the user's home directory

Development mode is automatically detected by the presence of `Cargo.toml` in the current directory.

## Usage

The CLI is organized into logical subcommands for different operations:

- **`project`** - Project management operations
- **`time`** - Time tracking operations
- **`export`** - Data export functionality

All time commands support both direct mode (with project slug) and selection mode (interactive project selection).

### Quick Examples

```bash
# Project management
timetracker project add my-website --name "My Website" --description "Personal site"
timetracker project list
timetracker project edit my-website
timetracker project delete my-website

# Time tracking (with project selection)
timetracker time start --description "Working on homepage"
timetracker time stop --description "Completed homepage design"
timetracker time status
timetracker time list
timetracker time total

# Time tracking (direct mode)
timetracker time start my-website --description "Working on homepage"
timetracker time stop --description "Completed homepage design" my-website
timetracker time status my-website
timetracker time list my-website
timetracker time total my-website

# Data export
timetracker export --output-dir ./backup --template "{project-name}_{timestamp}.json"
```

## API Structure

The tool interacts with a key-value store REST API with the following structure:

### Keys

- `projects`: Array of project objects
- `projects/<project-slug>`: Array of time entry objects

### Project Object

```js
{
  "name": "Project Name",
  "slug": "project-slug",
  "description": "Project description"
}
```

### Time Entry Object

```js
{
  "timestamp": 1234567890,
  "type": "start", // or "end"
  "description": "Optional description"
}
```

## Safety Features

The CLI includes several safety features to prevent accidental data loss:

- **Project deletion**: Requires explicit confirmation with "DELETE PROJECT"
- **Time entry deletion**: Supports both specific timestamp deletion and bulk deletion with confirmation
- **Selection interfaces**: Interactive project selection reduces typos
- **Logging**: All operations are logged for audit trails
- **Export functionality**: Easy data backup before making changes

## Development

To update the command documentation in this README:

```bash
./build.sh
```

This script automatically regenerates the Commands section using the latest CLI help output.

## Commands

<!-- BEGIN AUTO-GENERATED COMMANDS -->
<!-- This section is automatically generated by build.sh -->
<!-- Do not edit manually - changes will be overwritten -->

This document contains the help content for the `timetracker` command-line program.

**Command Overview:**

* [`timetracker`↴](#timetracker)
* [`timetracker project`↴](#timetracker-project)
* [`timetracker project add`↴](#timetracker-project-add)
* [`timetracker project list`↴](#timetracker-project-list)
* [`timetracker project edit`↴](#timetracker-project-edit)
* [`timetracker project delete`↴](#timetracker-project-delete)
* [`timetracker time`↴](#timetracker-time)
* [`timetracker time start`↴](#timetracker-time-start)
* [`timetracker time stop`↴](#timetracker-time-stop)
* [`timetracker time status`↴](#timetracker-time-status)
* [`timetracker time list`↴](#timetracker-time-list)
* [`timetracker time total`↴](#timetracker-time-total)
* [`timetracker time edit`↴](#timetracker-time-edit)
* [`timetracker time delete`↴](#timetracker-time-delete)
* [`timetracker export`↴](#timetracker-export)

## `timetracker`

A CLI tool for time tracking with REST API backend

**Usage:** `timetracker [COMMAND]`

###### **Subcommands:**

* `project` — Project management operations
* `time` — Time tracking operations
* `export` — Export all data as JSON files



## `timetracker project`

Project management operations

**Usage:** `timetracker project <COMMAND>`

###### **Subcommands:**

* `add` — Add a new project
* `list` — List all projects
* `edit` — Edit project details (name, description, slug)
* `delete` — Delete a project



## `timetracker project add`

Add a new project

**Usage:** `timetracker project add [OPTIONS] <SLUG>`

###### **Arguments:**

* `<SLUG>` — Project slug

###### **Options:**

* `-n`, `--name <NAME>` — Project name
* `-d`, `--description <DESCRIPTION>` — Project description



## `timetracker project list`

List all projects

**Usage:** `timetracker project list`



## `timetracker project edit`

Edit project details (name, description, slug)

**Usage:** `timetracker project edit [PROJECT]`

###### **Arguments:**

* `<PROJECT>` — Project slug (optional - if not provided, shows selection list)



## `timetracker project delete`

Delete a project

**Usage:** `timetracker project delete [PROJECT]`

###### **Arguments:**

* `<PROJECT>` — Project slug (optional - if not provided, shows selection list)



## `timetracker time`

Time tracking operations

**Usage:** `timetracker time <COMMAND>`

###### **Subcommands:**

* `start` — Start tracking time for a project
* `stop` — Stop tracking time for a project
* `status` — Check if a project is currently running
* `list` — List time entries for a project
* `total` — Show total time for a project
* `edit` — Edit the description of a time entry
* `delete` — Delete time entries for a project



## `timetracker time start`

Start tracking time for a project

**Usage:** `timetracker time start [OPTIONS] [PROJECT]`

###### **Arguments:**

* `<PROJECT>` — Project slug (optional - if not provided, shows selection list)

###### **Options:**

* `-d`, `--description <DESCRIPTION>` — Optional description



## `timetracker time stop`

Stop tracking time for a project

**Usage:** `timetracker time stop --description <DESCRIPTION> [PROJECT]`

###### **Arguments:**

* `<PROJECT>` — Project slug (optional - if not provided, shows selection list)

###### **Options:**

* `-d`, `--description <DESCRIPTION>` — Description of what was accomplished during this time session



## `timetracker time status`

Check if a project is currently running

**Usage:** `timetracker time status [PROJECT]`

###### **Arguments:**

* `<PROJECT>` — Project slug (optional - if not provided, shows selection list)



## `timetracker time list`

List time entries for a project

**Usage:** `timetracker time list [PROJECT]`

###### **Arguments:**

* `<PROJECT>` — Project slug (optional - if not provided, shows selection list)



## `timetracker time total`

Show total time for a project

**Usage:** `timetracker time total [PROJECT]`

###### **Arguments:**

* `<PROJECT>` — Project slug (optional - if not provided, shows selection list)



## `timetracker time edit`

Edit the description of a time entry

**Usage:** `timetracker time edit [PROJECT]`

###### **Arguments:**

* `<PROJECT>` — Project slug (optional - if not provided, shows selection list)



## `timetracker time delete`

Delete time entries for a project

**Usage:** `timetracker time delete [OPTIONS] [PROJECT]`

###### **Arguments:**

* `<PROJECT>` — Project slug (optional - if not provided, shows selection list)

###### **Options:**

* `-t`, `--timestamp <TIMESTAMP>` — Delete by specific timestamp (safer than deleting all)
* `--all` — Force delete ALL time entries (DANGEROUS! Requires confirmation)



## `timetracker export`

Export all data as JSON files

**Usage:** `timetracker export [OPTIONS]`

###### **Options:**

* `-o`, `--output-dir <OUTPUT_DIR>` — Output directory

  Default value: `./DATA`
* `-t`, `--filename-template <FILENAME_TEMPLATE>` — Filename template with placeholders: {project-name}, {timestamp}, {key-name}

  Default value: `{timestamp}_{key-name}.json`

<!-- END AUTO-GENERATED COMMANDS -->
